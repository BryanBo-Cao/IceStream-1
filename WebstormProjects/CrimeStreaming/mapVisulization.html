<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    </head>
    <body onload = "readFile();">
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        <p>CrimeStreaming.</p>

        <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.12.0.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='https://www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X','auto');ga('send','pageview');
        </script>

        <!-- Read Chicago.json -->
        <div id="map" style="width:100%;height:500px"></div>

        <script>
            var chicagoData = require('/dataset/Chicago.json');
            /*
            function myMap() {
                var mapCanvas = document.getElementById("map");
                var x_coordinates = [41.744147, 41.74396, 41.774078, 41.769373, 41.876554];
                var y_coordinates = [-87.66571, -87.665709, -87.598491, -87.57394, -87.763192];

                //var myCenter = new google.maps.LatLng(51.508742,-0.120850);
                var myCenter = new google.maps.LatLng(x_coordinates[0], y_coordinates[0]);
                var mapOptions = {center: myCenter, zoom: 5};
                var map = new google.maps.Map(mapCanvas,mapOptions);
                for (i = 0; i < x_coordinates.length; i++) {
                    var myLocation = new google.maps.LatLng(x_coordinates[i], y_coordinates[i]);
                    var marker = new google.maps.Marker({
                        position: myLocation,
                        animation: google.maps.Animation.BOUNCE
                    });
                    marker.setMap(map);
                }
            }
            */

//            function readFile() {
//                jQuery.get('dataset/Chicago.txt', function(txt) {
//                    $('#output').text(txt);
//                    dataFile = new String(txt);
//                });
//            }

            function myMap() {
                jQuery.get('dataset/Chicago.txt', function(txt) {
                    //$('#output').text(txt);
                    dataFile = new String(txt);

                    var longitudes = new Array();
                    var latitudes = new Array();
                    // for (i = 0; i < dataFile.length;) {
                    for (i = 0; i < 100000;) {
                        var coordinates_i = dataFile.indexOf("coordinates", i);
                        var end_of_longitude_i = dataFile.indexOf(",", coordinates_i);
                        var end_of_latitude_i = dataFile.indexOf("]", end_of_longitude_i);
                        var longitude = dataFile.substring(coordinates_i + 14, end_of_longitude_i);
                        var latitude = dataFile.substring(end_of_longitude_i + 1, end_of_latitude_i);
                        longitudes.push(longitude);
                        latitudes.push(latitude);
                        i = end_of_latitude_i + 1;
                    }

                    var mapCanvas = document.getElementById("map");
                    //var myCenter = new google.maps.LatLng(51.508742,-0.120850);
                    var myCenter = new google.maps.LatLng(latitudes[0], longitudes[0]);
                    var mapOptions = {center: myCenter, zoom: 5};
                    var map = new google.maps.Map(mapCanvas,mapOptions);
                    for (i = 0; i < longitudes.length; i++) {
                        var myLocation = new google.maps.LatLng(latitudes[i], longitudes[i]);
                        var marker = new google.maps.Marker({
                            position: myLocation,
                            animation: google.maps.Animation.BOUNCE
                        });
                        marker.setMap(map);
                    }

                });

            }
        </script>

        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQD_YGv2z4bP436IcJzJc6AA-RLXuzrZk&callback=myMap"></script>
        <!--<div id = "output"></div>-->
    </body>
</html>
